
[TOC]

## `u-boot`为什么需要重定位？

`u-boot`需要在内存中保留三个区域：

1. `u-boot`自身代码；
2. `uImage`(压缩的内核镜像)；
3. 解压的内核代码。

需要仔细处理这三个区域的地址空间，防止冲突。

在将`u-boot`代码加载到RAM内存中的引导程序初始阶段，比如`BL1`或`BL2`，其并不知道`u-boot`对这三个区域的规划。它只能先将`u-boot`加载到RAM的低地址空间，然后跳转到其中运行。然后，`u-boot`执行一些基本的初始化之后，检测到当前的PC指针与规划的地址不同，则`u-boot`调用`relocate`相关函数，将自身代码搬运到计划中的位置，然后长跳转到新位置，继续执行。

