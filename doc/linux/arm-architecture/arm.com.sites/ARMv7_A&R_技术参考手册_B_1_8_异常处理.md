[TOC]

An exception causes the processor to suspend program execution to handle an event, such as an externally generated interrupt or an attempt to execute an undefined instruction. Exceptions can be generated by internal and external sources.

Normally, when an exception is taken the processor state is preserved immediately, before handling the exception. This means that, when the event has been handled, the original state can be restored and program execution resumed from the point where the exception was taken.

More than one exception might be generated at the same time, and a new exception can be generated while the processor is handling an exception.

The following sections describe exception handling:

* Exception vectors and the exception base address
* Exception priority order on page B1-1169
* Overview of exception entry on page B1-1171
* Processor mode for taking exceptions on page B1-1173
* Processor state on exception entry on page B1-1182
* Asynchronous exception masking on page B1-1184
* Summaries of asynchronous exception behavior on page B1-1186
* Routing general exceptions to Hyp mode on page B1-1192
* Routing Debug exceptions to Hyp mode on page B1-1194
* Exception return on page B1-1194
* Virtual exceptions in the Virtualization Extensions on page B1-1197
* Low interrupt latency configuration on page B1-1198.
* Wait For Event and Send Event on page B1-1200
* Wait For Interrupt on page B1-1203.

Exception descriptions on page B1-1205 then describes each exception.

## 1 异常向量表和异常基地址

When an exception is taken, processor execution is forced to an address that corresponds to the type of exception. This address is called the exception vector for that exception.

A set of exception vectors comprises eight consecutive word-aligned memory addresses, starting at an exception base address. These eight vectors form a `vector table`. For the IRQ and FIQ exceptions only, when the exceptions are taken to IRQ mode and FIQ mode, software can change the exception vectors from the vector table values by setting the `SCTLR.VE` bit to `1`, see `Vectored interrupt` support on page B1-1168.

The number of possible exception base addresses, and therefore the number of vector tables, depends on the implemented architecture profile and extensions, as follows:

* 实现不包含安全扩展时：

    This section applied to all ARMv7-R implementations.

    An implementation that does not include the Security Extensions has a single vector table, the base address of which is selected by SCTLR.V, see SCTLR, System Control Register, VMSA on page B4-1707 or SCTLR, System Control Register, PMSA on page B6-1932:

    - **V == 0**
    
        异常基地址 `= 0x00000000`。这称为正常向量表，或低向量表。

    - **V == 1**
    
        异常基地址 `= 0xFFFF0000`。这称为高向量表，或者`Hivecs`。

    > ARM deprecates using the Hivecs setting, SCTLR.V == 1, in ARMv7-R. ARM recommends that Hivecs is used only in ARMv7-A implementations.

* 实现包含安全扩展时：

    Any implementation that includes the Security Extensions has the following vector tables:

    - One for exceptions taken to Secure Monitor mode. This is the Monitor vector table, and is in the address space of the Secure PL1&0 translation regime.

    - One for exceptions taken to Secure PL1 modes other than Monitor mode. This is the Secure vector table, and is in the address space of the Secure PL1&0 translation regime.

    - One for exceptions taken to Non-secure PL1 modes. This is the Non-secure vector table, and is in the address space of the Non-secure PL1&0 translation regime.

