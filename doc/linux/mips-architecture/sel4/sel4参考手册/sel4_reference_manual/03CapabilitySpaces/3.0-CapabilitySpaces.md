# 第3章  能力空间

第2.1节讲到，seL4实现了一个基于能力的访问控制模型。每个用户空间线程都有一个相关的*能力空间*(CSpace)，其中包含线程拥有的能力，从而控制线程的资源访问。

回想一下，能力驻留在称为CNodes的内核管理对象中。一个CNode是一个slot表，每个slot可以包含一个能力，这个能力也可能是对另一个CNode的引用，从而形成一个有向图。从概念上讲，一个线程的CSpace是从其根CNode能力开始可到达的有向图组成的空间。

CSpace地址指的是一个单独的slot(在CSpace中的某个CNode中)，它可能包含也可能不包含能力。线程通过使用容纳能力的slot地址，来引用它们CSpaces中的能力(如进行系统调用)。CSpace中的地址是通往目标slot路径中各级CNode能力索引的连接，我们将在第3.3节进一步讨论这个问题。

前面章节提到，能力可以在CSpaces中复制和移动，也可以通过消息进行传递(消息发送将在第4.2.2节中详细描述)。此外，新能力可以通过旧能力的权限子集来*生成*。还记得，在第2.4.1节中讲到，seL4维护了一个*能力派生树*(CDT)，用于跟踪这些复制能力与原始能力之间的关系。撤销方法可用于删除(在所有CSpaces中)从指定能力派生的所有能力。服务器程序可以使用此机制将权限恢复到授予客户端之前的唯一状态，或者未分配内存管理器用来销毁内存中的对象，以便重新分配内存。

seL4要求开发者从用户空间管理所有的内核数据结构，包括CSpaces。这意味着用户空间程序员要负责构造CSpace以及在它们内部进行能力寻址。本章首先讨论能力和CSpace管理，然后讨论如何在CSpaces中寻址能力，即应用程序调用方法时，怎样在它们的CSpaces中引用单个能力。
