### 10.3.6  seL4_SchedControl

#### 10.3.6.1  Configure

static inline int seL4_SchedControl_Configure

引用调度控制能力设置调度上下文(SC)的参数。如果SC绑定到了当前正在运行的线程，则这些参数将立即生效：即当前时间预算将根据新预算与先前预算之间的差额增加或减少，预算启用时间将根据周期差额进行更新。这可能导致活跃线程根据参数更改的性质和线程状态被推迟或释放(出待充值队列[^1])。另外，如果SC之前为空(没有预算)，但绑定的是一个可运行线程，这将使线程因为有了可以访问CPU的时间而首次运行。这个调用返回seL4_InvalidArgument，如果参数太小(小于此平台的内核WCET)或太大(将使定时器溢出)。

类型 | 名字 | 描述
--- | --- | ---
seL4_SchedControl | _service | 引用的SC控制能力句柄。自当前线程根CNode按机器字位数解析，下同
seL4_SchedContext | schedcontext | 要操作的SC能力句柄
seL4_Time | budget | 以毫秒计的时间片。当预算过期时线程将被抢占
seL4_Time | period | 以毫秒计的周期。如果等于budget，线程轮转调度；否则，sporadic server将确保SC在指定周期内运行不超过预算的时间
seL4_Word | extra_refills | 额外的补充单元数量。轮转线程忽略此参数
seL4_Word | badge | SC标记。超时异常时发送给处理线程，用以确定触发超时的SC

*返回值*：返回0表示成功，非0值表示有错误发生；第10.1节描述了发生错误时消息寄存器和消息标签有关内容。

*描述*：见第6.1节。

[^1]: SC预算已经用完且下次预算启用时间尚未到来的线程，将被放入release队列，等待预算启用时间的到来，为方便这里称这个队列为“待充值队列”。seL4实现上，这个队列与调度队列(ready队列)使用共同的链接指针字段，显然这是合理的，因为一个线程不可能同时处于这两种状态，这两个队列的头指针是不同的以作区分。
